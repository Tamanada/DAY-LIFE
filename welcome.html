<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DAYLIFE â€“ Welcome</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Style global de l'app -->
  <link rel="stylesheet" href="assets/style.css" />

  <style>
    /* ===== STYLES SPÃ‰CIFIQUES Ã€ LA PAGE WELCOME ===== */

    body {
      margin: 0;
    }

    .welcome-page {
      display: flex;
      align-items: center;
      justify-content: center;
      padding-top: 40px;
      padding-bottom: 40px;
    }

    .welcome-inner {
      max-width: 520px;
      margin: 0 auto;
    }

    .welcome-card {
      background: radial-gradient(circle at top left, #eef2ff, #ffffff 45%, #fef2ff);
      border-radius: 24px;
      padding: 24px 20px 22px;
      box-shadow: 0 24px 60px rgba(15, 23, 42, 0.14);
      border: 1px solid rgba(209, 213, 219, 0.9);
    }

    .welcome-logo {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      margin: 0 auto 12px;
      background: radial-gradient(circle at 30% 20%, #f9fafb, #1d4ed8, #7c3aed);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ffffff;
      font-size: 28px;
      box-shadow: 0 18px 40px rgba(79, 70, 229, 0.45);
    }

    .welcome-title {
      text-align: center;
      font-size: 24px;
      margin: 0 0 6px;
      font-weight: 700;
    }

    .welcome-tagline {
      text-align: center;
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 20px;
    }

    .welcome-form {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .welcome-field {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 13px;
    }

    .welcome-field label {
      font-weight: 500;
      color: #374151;
    }

    .welcome-input,
    .welcome-select {
      padding: 9px 11px;
      border-radius: 999px;
      border: 1px solid #cbd5e1;
      font-size: 14px;
      outline: none;
      background: #f9fafb;
      transition: border-color 0.16s ease, box-shadow 0.16s ease, background-color 0.16s ease;
    }

    .welcome-input:focus,
    .welcome-select:focus {
      border-color: #7c3aed;
      box-shadow: 0 0 0 1px rgba(124, 58, 237, 0.3);
      background-color: #ffffff;
    }

    .welcome-helper {
      font-size: 11px;
      color: #6b7280;
    }

    .welcome-btn {
      margin-top: 8px;
      width: 100%;
      border: none;
      border-radius: 999px;
      padding: 12px 16px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(90deg, #2563eb, #7c3aed);
      color: #ffffff;
      transition: filter 0.15s ease, transform 0.1s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .welcome-btn:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
    }

    .welcome-btn:active {
      transform: translateY(0);
    }

    .welcome-btn:disabled {
      cursor: not-allowed;
      opacity: 0.6;
      transform: none;
    }

    .welcome-result {
      margin-top: 10px;
      font-size: 13px;
      text-align: center;
    }

    .welcome-result.error {
      color: #dc2626;
    }

    .welcome-result.success {
      color: #16a34a;
    }

    .lang-select-top {
      min-width: 120px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 12px;
      background: rgba(255, 255, 255, 0.9);
      outline: none;
    }

    @media (max-width: 640px) {
      .welcome-page {
        padding-top: 16px;
        padding-bottom: 24px;
      }

      .welcome-card {
        border-radius: 20px;
        padding: 20px 16px 18px;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <!-- HEADER SIMPLIFIÃ‰ : LOGO + LANGUE -->
    <header class="app-header">
      <div class="app-header-inner">
        <div class="brand">
          <div class="brand-orbit">ðŸŒ•</div>
          <div>
            <div class="brand-text-main">DAYLIFE</div>
            <div class="brand-text-sub">30 000 Days</div>
          </div>
        </div>
        <div class="top-nav">
          <select id="languageSelect" class="lang-select-top"></select>
        </div>
      </div>
    </header>

    <!-- CONTENU PRINCIPAL -->
    <main class="page welcome-page">
      <div class="page-inner welcome-inner">
        <section class="section">
          <div class="card welcome-card">
            <div class="welcome-logo">
              <i data-lucide="sparkles"></i>
            </div>
            <h1 class="welcome-title" id="headline">DAYLIFE</h1>
            <p class="welcome-tagline" id="tagline">
              Every day counts. What will you do with yours?
            </p>

            <form id="setupForm" class="welcome-form">
              <!-- Date de naissance -->
              <div class="welcome-field">
                <label for="dob" id="dobLabel">Date of birth *</label>
                <input type="date" id="dob" class="welcome-input" />
                <div class="welcome-helper" id="dobHelper">
                  We use this to calculate how many days youâ€™ve already lived.
                </div>
              </div>

              <!-- Sexe -->
              <div class="welcome-field">
                <label for="sex" id="sexLabel">Sex *</label>
                <select id="sex" class="welcome-select">
                  <option value="" id="sexPlaceholder">Select your sex</option>
                  <option value="male" id="sexMale">Male</option>
                  <option value="female" id="sexFemale">Female</option>
                </select>
              </div>

              <!-- Pays -->
              <div class="welcome-field">
                <label for="country" id="countryLabel">Country of birth *</label>
                <select id="country" class="welcome-select">
                  <!-- options gÃ©nÃ©rÃ©es par JS -->
                </select>
                <div class="welcome-helper" id="countryHelper">
                  Used to estimate your real life expectancy based on demographics.
                </div>
              </div>

              <!-- MÃ©thode de calcul -->
              <div class="welcome-field">
                <label for="calculationMode" id="calcLabel">Life calculation method</label>
                <select id="calculationMode" class="welcome-select">
                  <option value="30000_days" id="calc30000">
                    30,000 days (default)
                  </option>
                  <option value="by_demographics" id="calcReal">
                    Real (based on my profile)
                  </option>
                </select>
                <div class="welcome-helper" id="calcHelper">
                  You can change this later in your profile.
                </div>
              </div>

              <button type="submit" class="welcome-btn" id="startButton">
                <i data-lucide="play-circle"></i>
                <span>Start my journey</span>
              </button>
            </form>

            <p id="resultMessage" class="welcome-result"></p>
          </div>
        </section>
      </div>
    </main>
  </div>

  <!-- LIBRAIRIES -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <script>
    // =============== TRADUCTIONS (12 LANGUES) ===============

    const welcomeTranslations = {
      en: {
        langName: "English",
        tagline: "Every day counts. What will you do with yours?",
        dobLabel: "Date of birth *",
        dobHelper: "We use this to calculate how many days youâ€™ve already lived.",
        sexLabel: "Sex *",
        sexPlaceholder: "Select your sex",
        sexMale: "Male",
        sexFemale: "Female",
        countryLabel: "Country of birth *",
        countryHelper: "Used to estimate your real life expectancy based on demographics.",
        calcLabel: "Life calculation method",
        calc30000: "30,000 days (default)",
        calcReal: "Real (based on my profile)",
        calcHelper: "You can change this later in your profile.",
        startButton: "Start my journey",
        errorIncomplete: "Please fill in all required fields.",
        successSaved: "Profile saved. Welcome to DAYLIFE! ðŸŒ•",
      },
      fr: {
        langName: "FranÃ§ais",
        tagline: "Chaque jour compte. Que ferez-vous du vÃ´tre ?",
        dobLabel: "Date de naissance *",
        dobHelper: "Nous lâ€™utilisons pour calculer combien de jours vous avez dÃ©jÃ  vÃ©cus.",
        sexLabel: "Sexe *",
        sexPlaceholder: "SÃ©lectionnez votre sexe",
        sexMale: "Homme",
        sexFemale: "Femme",
        countryLabel: "Pays de naissance *",
        countryHelper: "UtilisÃ© pour estimer votre espÃ©rance de vie rÃ©elle selon les donnÃ©es dÃ©mographiques.",
        calcLabel: "MÃ©thode de calcul de vie",
        calc30000: "30 000 jours (par dÃ©faut)",
        calcReal: "RÃ©el (selon mon profil)",
        calcHelper: "Vous pourrez modifier ce choix plus tard dans votre profil.",
        startButton: "Commencer mon voyage",
        errorIncomplete: "Veuillez remplir tous les champs obligatoires.",
        successSaved: "Profil enregistrÃ©. Bienvenue dans DAYLIFE ! ðŸŒ•",
      },
      es: {
        langName: "EspaÃ±ol",
        tagline: "Cada dÃ­a cuenta. Â¿QuÃ© harÃ¡s con el tuyo?",
        dobLabel: "Fecha de nacimiento *",
        dobHelper: "La usamos para calcular cuÃ¡ntos dÃ­as ya has vivido.",
        sexLabel: "Sexo *",
        sexPlaceholder: "Selecciona tu sexo",
        sexMale: "Hombre",
        sexFemale: "Mujer",
        countryLabel: "PaÃ­s de nacimiento *",
        countryHelper: "Se usa para estimar tu esperanza de vida real segÃºn tu paÃ­s.",
        calcLabel: "MÃ©todo de cÃ¡lculo de vida",
        calc30000: "30.000 dÃ­as (por defecto)",
        calcReal: "Real (segÃºn mi perfil)",
        calcHelper: "Puedes cambiar esto mÃ¡s tarde en tu perfil.",
        startButton: "Empezar mi viaje",
        errorIncomplete: "Por favor completa todos los campos obligatorios.",
        successSaved: "Perfil guardado. Â¡Bienvenido a DAYLIFE! ðŸŒ•",
      },
      de: {
        langName: "Deutsch",
        tagline: "Jeder Tag zÃ¤hlt. Was machst du aus deinem?",
        dobLabel: "Geburtsdatum *",
        dobHelper: "Wir verwenden es, um zu berechnen, wie viele Tage du bereits gelebt hast.",
        sexLabel: "Geschlecht *",
        sexPlaceholder: "WÃ¤hle dein Geschlecht",
        sexMale: "MÃ¤nnlich",
        sexFemale: "Weiblich",
        countryLabel: "Geburtsland *",
        countryHelper: "Wird verwendet, um deine tatsÃ¤chliche Lebenserwartung zu schÃ¤tzen.",
        calcLabel: "Lebensberechnung",
        calc30000: "30.000 Tage (Standard)",
        calcReal: "Real (basierend auf meinem Profil)",
        calcHelper: "Du kannst dies spÃ¤ter in deinem Profil Ã¤ndern.",
        startButton: "Meine Reise starten",
        errorIncomplete: "Bitte fÃ¼lle alle Pflichtfelder aus.",
        successSaved: "Profil gespeichert. Willkommen bei DAYLIFE! ðŸŒ•",
      },
      pt: {
        langName: "PortuguÃªs",
        tagline: "Cada dia conta. O que vocÃª farÃ¡ com o seu?",
        dobLabel: "Data de nascimento *",
        dobHelper: "Usamos isso para calcular quantos dias vocÃª jÃ¡ viveu.",
        sexLabel: "Sexo *",
        sexPlaceholder: "Selecione seu sexo",
        sexMale: "Homem",
        sexFemale: "Mulher",
        countryLabel: "PaÃ­s de nascimento *",
        countryHelper: "Usado para estimar sua expectativa de vida real.",
        calcLabel: "MÃ©todo de cÃ¡lculo de vida",
        calc30000: "30.000 dias (padrÃ£o)",
        calcReal: "Real (com base no meu perfil)",
        calcHelper: "VocÃª pode alterar isso depois no seu perfil.",
        startButton: "ComeÃ§ar minha jornada",
        errorIncomplete: "Por favor, preencha todos os campos obrigatÃ³rios.",
        successSaved: "Perfil salvo. Bem-vindo ao DAYLIFE! ðŸŒ•",
      },
      it: {
        langName: "Italiano",
        tagline: "Ogni giorno conta. Cosa farai del tuo?",
        dobLabel: "Data di nascita *",
        dobHelper: "La usiamo per calcolare quanti giorni hai giÃ  vissuto.",
        sexLabel: "Sesso *",
        sexPlaceholder: "Seleziona il tuo sesso",
        sexMale: "Uomo",
        sexFemale: "Donna",
        countryLabel: "Paese di nascita *",
        countryHelper: "Usato per stimare la tua aspettativa di vita reale.",
        calcLabel: "Metodo di calcolo della vita",
        calc30000: "30.000 giorni (predefinito)",
        calcReal: "Reale (in base al mio profilo)",
        calcHelper: "Puoi cambiare questa opzione piÃ¹ tardi nel tuo profilo.",
        startButton: "Inizia il mio viaggio",
        errorIncomplete: "Compila tutti i campi obbligatori.",
        successSaved: "Profilo salvato. Benvenuto in DAYLIFE! ðŸŒ•",
      },
      zh: {
        langName: "ä¸­æ–‡",
        tagline: "æ¯ä¸€å¤©éƒ½å¾ˆé‡è¦ï¼Œä½ ä¼šå¦‚ä½•ä½¿ç”¨å®ƒï¼Ÿ",
        dobLabel: "å‡ºç”Ÿæ—¥æœŸ *",
        dobHelper: "ç”¨äºŽè®¡ç®—ä½ å·²ç»åº¦è¿‡äº†å¤šå°‘å¤©ã€‚",
        sexLabel: "æ€§åˆ« *",
        sexPlaceholder: "é€‰æ‹©ä½ çš„æ€§åˆ«",
        sexMale: "ç”·",
        sexFemale: "å¥³",
        countryLabel: "å‡ºç”Ÿå›½å®¶ *",
        countryHelper: "æ ¹æ®äººå£ç»Ÿè®¡ä¼°ç®—ä½ çš„é¢„æœŸå¯¿å‘½ã€‚",
        calcLabel: "ç”Ÿå‘½è®¡ç®—æ–¹å¼",
        calc30000: "30,000 å¤©ï¼ˆé»˜è®¤ï¼‰",
        calcReal: "çœŸå®žï¼ˆåŸºäºŽæˆ‘çš„èµ„æ–™ï¼‰",
        calcHelper: "ä½ å¯ä»¥ç¨åŽåœ¨ä¸ªäººèµ„æ–™ä¸­ä¿®æ”¹ã€‚",
        startButton: "å¼€å§‹æˆ‘çš„æ—…ç¨‹",
        errorIncomplete: "è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µã€‚",
        successSaved: "èµ„æ–™å·²ä¿å­˜ï¼Œæ¬¢è¿Žæ¥åˆ° DAYLIFEï¼ðŸŒ•",
      },
      hi: {
        langName: "à¤¹à¤¿à¤¨à¥à¤¦à¥€",
        tagline: "à¤¹à¤° à¤¦à¤¿à¤¨ à¤®à¤¾à¤¯à¤¨à¥‡ à¤°à¤–à¤¤à¤¾ à¤¹à¥ˆà¥¤ à¤†à¤ª à¤…à¤ªà¤¨à¥‡ à¤¦à¤¿à¤¨ à¤•à¤¾ à¤•à¥à¤¯à¤¾ à¤•à¤°à¥‡à¤‚à¤—à¥‡?",
        dobLabel: "à¤œà¤¨à¥à¤® à¤¤à¤¿à¤¥à¤¿ *",
        dobHelper: "à¤¹à¤® à¤‡à¤¸à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤¯à¤¹ à¤—à¤£à¤¨à¤¾ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚ à¤•à¤¿ à¤†à¤ªà¤¨à¥‡ à¤•à¤¿à¤¤à¤¨à¥‡ à¤¦à¤¿à¤¨ à¤œà¥€ à¤²à¤¿à¤ à¤¹à¥ˆà¤‚à¥¤",
        sexLabel: "à¤²à¤¿à¤‚à¤— *",
        sexPlaceholder: "à¤…à¤ªà¤¨à¤¾ à¤²à¤¿à¤‚à¤— à¤šà¥à¤¨à¥‡à¤‚",
        sexMale: "à¤ªà¥à¤°à¥à¤·",
        sexFemale: "à¤®à¤¹à¤¿à¤²à¤¾",
        countryLabel: "à¤œà¤¨à¥à¤® à¤•à¤¾ à¤¦à¥‡à¤¶ *",
        countryHelper: "à¤†à¤ªà¤•à¥€ à¤µà¤¾à¤¸à¥à¤¤à¤µà¤¿à¤• à¤œà¥€à¤µà¤¨ à¤ªà¥à¤°à¤¤à¥à¤¯à¤¾à¤¶à¤¾ à¤•à¤¾ à¤…à¤¨à¥à¤®à¤¾à¤¨ à¤²à¤—à¤¾à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤à¥¤",
        calcLabel: "à¤œà¥€à¤µà¤¨ à¤—à¤£à¤¨à¤¾ à¤µà¤¿à¤§à¤¿",
        calc30000: "30,000 à¤¦à¤¿à¤¨ (à¤¡à¤¿à¤«à¤¼à¥‰à¤²à¥à¤Ÿ)",
        calcReal: "à¤µà¤¾à¤¸à¥à¤¤à¤µà¤¿à¤• (à¤®à¥‡à¤°à¥‡ à¤ªà¥à¤°à¥‹à¤«à¤¼à¤¾à¤‡à¤² à¤•à¥‡ à¤…à¤¨à¥à¤¸à¤¾à¤°)",
        calcHelper: "à¤†à¤ª à¤¬à¤¾à¤¦ à¤®à¥‡à¤‚ à¤…à¤ªà¤¨à¥‡ à¤ªà¥à¤°à¥‹à¤«à¤¼à¤¾à¤‡à¤² à¤®à¥‡à¤‚ à¤‡à¤¸à¥‡ à¤¬à¤¦à¤² à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤",
        startButton: "à¤®à¥‡à¤°à¥€ à¤¯à¤¾à¤¤à¥à¤°à¤¾ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚",
        errorIncomplete: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¸à¤­à¥€ à¤†à¤µà¤¶à¥à¤¯à¤• à¤«à¤¼à¥€à¤²à¥à¤¡ à¤­à¤°à¥‡à¤‚à¥¤",
        successSaved: "à¤ªà¥à¤°à¥‹à¤«à¤¼à¤¾à¤‡à¤² à¤¸à¤¹à¥‡à¤œà¥€ à¤—à¤ˆà¥¤ DAYLIFE à¤®à¥‡à¤‚ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ! ðŸŒ•",
      },
      ar: {
        langName: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
        tagline: "ÙƒÙ„ ÙŠÙˆÙ… Ù…Ù‡Ù…. Ù…Ø§Ø°Ø§ Ø³ØªÙØ¹Ù„ Ø¨ÙŠÙˆÙ…ÙƒØŸ",
        dobLabel: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ *",
        dobHelper: "Ù†Ø³ØªØ®Ø¯Ù…Ù‡ Ù„Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„ØªÙŠ Ø¹Ø´ØªÙ‡Ø§.",
        sexLabel: "Ø§Ù„Ø¬Ù†Ø³ *",
        sexPlaceholder: "Ø§Ø®ØªØ± Ø¬Ù†Ø³Ùƒ",
        sexMale: "Ø°ÙƒØ±",
        sexFemale: "Ø£Ù†Ø«Ù‰",
        countryLabel: "Ø¨Ù„Ø¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ *",
        countryHelper: "ÙŠÙØ³ØªØ®Ø¯Ù… Ù„ØªÙ‚Ø¯ÙŠØ± Ù…ØªÙˆØ³Ø· Ø¹Ù…Ø±Ùƒ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹.",
        calcLabel: "Ø·Ø±ÙŠÙ‚Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­ÙŠØ§Ø©",
        calc30000: "30,000 ÙŠÙˆÙ… (Ø§ÙØªØ±Ø§Ø¶ÙŠ)",
        calcReal: "Ø­Ù‚ÙŠÙ‚ÙŠ (ÙˆÙÙ‚Ù‹Ø§ Ù„Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ)",
        calcHelper: "ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ù‡Ø°Ø§ Ù„Ø§Ø­Ù‚Ù‹Ø§ ÙÙŠ ØµÙØ­ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©.",
        startButton: "Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙŠ",
        errorIncomplete: "ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.",
        successSaved: "ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ. Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ DAYLIFE! ðŸŒ•",
      },
      ru: {
        langName: "Ð ÑƒÑÑÐºÐ¸Ð¹",
        tagline: "ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ Ð²Ð°Ð¶ÐµÐ½. Ð§Ñ‚Ð¾ Ñ‚Ñ‹ ÑÐ´ÐµÐ»Ð°ÐµÑˆÑŒ ÑÐ¾ ÑÐ²Ð¾Ð¸Ð¼?",
        dobLabel: "Ð”Ð°Ñ‚Ð° Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ *",
        dobHelper: "ÐœÑ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÐµÑ‘, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾ÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ, ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð´Ð½ÐµÐ¹ Ñ‚Ñ‹ ÑƒÐ¶Ðµ Ð¿Ñ€Ð¾Ð¶Ð¸Ð».",
        sexLabel: "ÐŸÐ¾Ð» *",
        sexPlaceholder: "Ð’Ñ‹Ð±ÐµÑ€Ð¸ ÑÐ²Ð¾Ð¹ Ð¿Ð¾Ð»",
        sexMale: "ÐœÑƒÐ¶ÑÐºÐ¾Ð¹",
        sexFemale: "Ð–ÐµÐ½ÑÐºÐ¸Ð¹",
        countryLabel: "Ð¡Ñ‚Ñ€Ð°Ð½Ð° Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ *",
        countryHelper: "Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¾Ñ†ÐµÐ½ÐºÐ¸ Ñ‚Ð²Ð¾ÐµÐ¹ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼Ð¾Ð¹ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð¶Ð¸Ð·Ð½Ð¸.",
        calcLabel: "Ð¡Ð¿Ð¾ÑÐ¾Ð± Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð° Ð¶Ð¸Ð·Ð½Ð¸",
        calc30000: "30 000 Ð´Ð½ÐµÐ¹ (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ)",
        calcReal: "Ð ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ (Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¼Ð¾ÐµÐ³Ð¾ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ)",
        calcHelper: "Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ ÑÑ‚Ð¾ Ð¿Ð¾Ð·Ð¶Ðµ Ð² Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ðµ.",
        startButton: "ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¿ÑƒÑ‚ÑŒ",
        errorIncomplete: "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð·Ð°Ð¿Ð¾Ð»Ð½Ð¸ Ð²ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ.",
        successSaved: "ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ ÑÐ¾Ñ…Ñ€Ð°Ð½Ñ‘Ð½. Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² DAYLIFE! ðŸŒ•",
      },
      th: {
        langName: "à¹„à¸—à¸¢",
        tagline: "à¸—à¸¸à¸à¸§à¸±à¸™à¸¡à¸µà¸„à¸§à¸²à¸¡à¸«à¸¡à¸²à¸¢ à¸„à¸¸à¸“à¸ˆà¸°à¹ƒà¸Šà¹‰à¸§à¸±à¸™à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£?",
        dobLabel: "à¸§à¸±à¸™à¹€à¸”à¸·à¸­à¸™à¸›à¸µà¹€à¸à¸´à¸” *",
        dobHelper: "à¹€à¸£à¸²à¹ƒà¸Šà¹‰à¹€à¸žà¸·à¹ˆà¸­à¸„à¸³à¸™à¸§à¸“à¸§à¹ˆà¸²à¸„à¸¸à¸“à¹ƒà¸Šà¹‰à¸Šà¸µà¸§à¸´à¸•à¸¡à¸²à¹à¸¥à¹‰à¸§à¸à¸µà¹ˆà¸§à¸±à¸™",
        sexLabel: "à¹€à¸žà¸¨ *",
        sexPlaceholder: "à¹€à¸¥à¸·à¸­à¸à¹€à¸žà¸¨à¸‚à¸­à¸‡à¸„à¸¸à¸“",
        sexMale: "à¸Šà¸²à¸¢",
        sexFemale: "à¸«à¸à¸´à¸‡",
        countryLabel: "à¸›à¸£à¸°à¹€à¸—à¸¨à¹€à¸à¸´à¸” *",
        countryHelper: "à¹ƒà¸Šà¹‰à¸›à¸£à¸°à¸¡à¸²à¸“à¸­à¸²à¸¢à¸¸à¸‚à¸±à¸¢à¸•à¸²à¸¡à¸ªà¸–à¸´à¸•à¸´à¸‚à¸­à¸‡à¸›à¸£à¸°à¹€à¸—à¸¨à¸„à¸¸à¸“",
        calcLabel: "à¸§à¸´à¸˜à¸µà¸„à¸³à¸™à¸§à¸“à¸Šà¸µà¸§à¸´à¸•",
        calc30000: "30,000 à¸§à¸±à¸™ (à¸„à¹ˆà¸²à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™)",
        calcReal: "à¸ˆà¸£à¸´à¸‡ (à¸•à¸²à¸¡à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œà¸‚à¸­à¸‡à¸‰à¸±à¸™)",
        calcHelper: "à¸„à¸¸à¸“à¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ à¸²à¸¢à¸«à¸¥à¸±à¸‡à¹„à¸”à¹‰à¹ƒà¸™à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œ",
        startButton: "à¹€à¸£à¸´à¹ˆà¸¡à¸à¸²à¸£à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¸‚à¸­à¸‡à¸‰à¸±à¸™",
        errorIncomplete: "à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™à¹ƒà¸«à¹‰à¸„à¸£à¸šà¸–à¹‰à¸§à¸™",
        successSaved: "à¸šà¸±à¸™à¸—à¸¶à¸à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œà¹à¸¥à¹‰à¸§ à¸¢à¸´à¸™à¸”à¸µà¸•à¹‰à¸­à¸™à¸£à¸±à¸šà¸ªà¸¹à¹ˆ DAYLIFE! ðŸŒ•",
      },
      my: {
        langName: "á€™á€¼á€”á€ºá€™á€¬",
        tagline: "á€”á€±á€·á€á€­á€¯á€„á€ºá€¸ á€¡á€›á€±á€¸á€€á€¼á€®á€¸á€•á€«á€á€šá€ºáŠ á€™á€„á€ºá€¸á€›á€²á€·á€”á€±á€·á€€á€­á€¯ á€˜á€¬á€¡á€á€½á€€á€º á€žá€¯á€¶á€¸á€™á€œá€²?",
        dobLabel: "á€™á€½á€±á€¸á€žá€€á€¹á€€á€›á€¬á€‡á€º *",
        dobHelper: "á€™á€„á€ºá€¸ á€˜á€šá€ºá€œá€±á€¬á€€á€ºá€”á€±á€· á€”á€±á€‘á€­á€¯á€„á€ºá€á€²á€·á€•á€¼á€®á€¸á€”á€±á€•á€¼á€®á€œá€² á€…á€¯á€á€»á€€á€ºá€á€½á€€á€ºá€›á€”á€º á€žá€¯á€¶á€¸á€•á€«á€á€šá€ºá‹",
        sexLabel: "á€œá€­á€„á€º *",
        sexPlaceholder: "á€™á€„á€ºá€¸á€›á€²á€·á€œá€­á€„á€ºá€€á€­á€¯ á€›á€½á€±á€¸á€•á€«",
        sexMale: "á€€á€»á€¬á€¸",
        sexFemale: "á€™",
        countryLabel: "á€™á€½á€±á€¸á€–á€½á€¬á€¸á€žá€Šá€·á€º á€”á€­á€¯á€„á€ºá€„á€¶ *",
        countryHelper: "á€™á€„á€ºá€¸á€›á€²á€·á€œá€°á€¦á€¸á€›á€±á€žØ§Ø­á€á€„á€º á€¡á€€á€¼á€™á€ºá€¸á€–á€»á€‰á€ºá€¸ á€¡á€žá€€á€ºá€›á€¾á€Šá€ºá€›á€„á€ºá€¾á€¬ á€™á€¾á€”á€ºá€¸á€á€¼á€±á€–á€­á€¯á€· á€žá€¯á€¶á€¸á€•á€«á€á€šá€ºá‹",
        calcLabel: "á€¡á€žá€€á€ºá€›á€¾á€Šá€º á€›á€±á€á€½á€€á€ºá€•á€¯á€¶",
        calc30000: "á€›á€€á€º áƒá€,á€á€á€ (á€™á€°á€œá€žá€á€ºá€™á€¾á€á€ºá€á€»á€€á€º)",
        calcReal: "á€á€€á€šá€·á€º (á€€á€»á€½á€”á€ºá€á€±á€¬á€º/á€€á€»á€½á€”á€ºá€™á€›á€²á€· á€•á€›á€­á€¯á€–á€­á€¯á€„á€ºá€¡á€•á€±á€«á€ºá€™á€°á€á€Šá€ºá)",
        calcHelper: "á€”á€±á€¬á€€á€ºá€™á€¾á€¬ á€•á€›á€­á€¯á€–á€­á€¯á€„á€ºá€‘á€²á€™á€¾á€¬ á€•á€¼á€”á€ºá€•á€¼á€„á€ºá€œá€­á€¯á€· á€›á€•á€«á€á€šá€ºá‹",
        startButton: "á€€á€»á€½á€”á€ºá€á€±á€¬á€º/á€€á€»á€½á€”á€ºá€™á€›á€²á€· á€á€›á€®á€¸á€…á€‰á€º á€…á€á€„á€ºá€™á€šá€º",
        errorIncomplete: "á€œá€­á€¯á€¡á€•á€ºá€žá€±á€¬ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€¡á€¬á€¸á€œá€¯á€¶á€¸ á€–á€¼á€Šá€·á€ºá€žá€½á€„á€ºá€¸á€•á€«á‹",
        successSaved: "á€•á€›á€­á€¯á€–á€­á€¯á€„á€º á€žá€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹ DAYLIFE á€™á€¾ á€€á€¼á€­á€¯á€†á€­á€¯á€•á€«á€á€šá€º! ðŸŒ•",
      },
    };

    const supportedLanguages = [
      "en",
      "fr",
      "es",
      "de",
      "pt",
      "it",
      "zh",
      "hi",
      "ar",
      "ru",
      "th",
      "my",
    ];

    // =============== LISTE DES PAYS (ISO 2) ===============
    // (liste non exhaustive parfaite, mais large pour le monde)

    const countries = [
      { code: "", name: "Select your country" },
      { code: "FR", name: "France" },
      { code: "TH", name: "Thailand" },
      { code: "MM", name: "Myanmar" },
      { code: "US", name: "United States" },
      { code: "CA", name: "Canada" },
      { code: "GB", name: "United Kingdom" },
      { code: "DE", name: "Germany" },
      { code: "ES", name: "Spain" },
      { code: "IT", name: "Italy" },
      { code: "PT", name: "Portugal" },
      { code: "BR", name: "Brazil" },
      { code: "MX", name: "Mexico" },
      { code: "AR", name: "Argentina" },
      { code: "CL", name: "Chile" },
      { code: "CO", name: "Colombia" },
      { code: "PE", name: "Peru" },
      { code: "VE", name: "Venezuela" },
      { code: "RU", name: "Russia" },
      { code: "UA", name: "Ukraine" },
      { code: "PL", name: "Poland" },
      { code: "NL", name: "Netherlands" },
      { code: "BE", name: "Belgium" },
      { code: "CH", name: "Switzerland" },
      { code: "SE", name: "Sweden" },
      { code: "NO", name: "Norway" },
      { code: "FI", name: "Finland" },
      { code: "DK", name: "Denmark" },
      { code: "IE", name: "Ireland" },
      { code: "IS", name: "Iceland" },
      { code: "PT", name: "Portugal" },
      { code: "GR", name: "Greece" },
      { code: "TR", name: "Turkey" },
      { code: "SA", name: "Saudi Arabia" },
      { code: "AE", name: "United Arab Emirates" },
      { code: "EG", name: "Egypt" },
      { code: "MA", name: "Morocco" },
      { code: "DZ", name: "Algeria" },
      { code: "TN", name: "Tunisia" },
      { code: "NG", name: "Nigeria" },
      { code: "KE", name: "Kenya" },
      { code: "GH", name: "Ghana" },
      { code: "ZA", name: "South Africa" },
      { code: "IN", name: "India" },
      { code: "PK", name: "Pakistan" },
      { code: "BD", name: "Bangladesh" },
      { code: "LK", name: "Sri Lanka" },
      { code: "NP", name: "Nepal" },
      { code: "CN", name: "China" },
      { code: "JP", name: "Japan" },
      { code: "KR", name: "South Korea" },
      { code: "ID", name: "Indonesia" },
      { code: "MY", name: "Malaysia" },
      { code: "PH", name: "Philippines" },
      { code: "VN", name: "Vietnam" },
      { code: "SG", name: "Singapore" },
      { code: "AU", name: "Australia" },
      { code: "NZ", name: "New Zealand" },
      // Tu pourras en ajouter d'autres si tu veux Ãªtre 100% ISO-3166
    ];

    // ========= Fonction pour appliquer la langue Ã  la page =========

    function applyLang(lang) {
      const t = welcomeTranslations[lang] || welcomeTranslations["en"];

      document.getElementById("tagline").textContent = t.tagline;
      document.getElementById("dobLabel").textContent = t.dobLabel;
      document.getElementById("dobHelper").textContent = t.dobHelper;
      document.getElementById("sexLabel").textContent = t.sexLabel;
      document.getElementById("sexPlaceholder").textContent = t.sexPlaceholder;
      document.getElementById("sexMale").textContent = t.sexMale;
      document.getElementById("sexFemale").textContent = t.sexFemale;
      document.getElementById("countryLabel").textContent = t.countryLabel;
      document.getElementById("countryHelper").textContent = t.countryHelper;
      document.getElementById("calcLabel").textContent = t.calcLabel;
      document.getElementById("calc30000").textContent = t.calc30000;
      document.getElementById("calcReal").textContent = t.calcReal;
      document.getElementById("calcHelper").textContent = t.calcHelper;
      document.getElementById("startButton").querySelector("span").textContent =
        t.startButton;
    }

    // ========= Life expectancy API =========
    // Utilise l'API World Bank (donnÃ©es globales), puis ajuste lÃ©gÃ¨rement par sexe.

    async function fetchLifeExpectancyDays(countryCode, sex) {
      const url =
        "https://api.worldbank.org/v2/country/" +
        countryCode +
        "/indicator/SP.DYN.LE00.IN?format=json";

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error("API error");
        const data = await res.json();
        let years = null;

        if (Array.isArray(data) && Array.isArray(data[1])) {
          for (const row of data[1]) {
            if (row && row.value != null) {
              years = row.value;
              break;
            }
          }
        }

        if (!years) {
          years = 80; // fallback
        }

        // Ajustement simple par sexe
        if (sex === "female") years += 3;
        if (sex === "male") years -= 2;

        return Math.round(years * 365.25);
      } catch (e) {
        // Fallback simple si l'API est inaccessible / CORS
        const baseYears = sex === "female" ? 82 : 78;
        return Math.round(baseYears * 365.25);
      }
    }

    // ========= INIT =========

    document.addEventListener("DOMContentLoaded", () => {
      if (window.lucide) {
        lucide.createIcons();
      }

      const resultEl = document.getElementById("resultMessage");
      const langSelect = document.getElementById("languageSelect");
      const countrySelect = document.getElementById("country");

      // âš ï¸ Si le profil existe dÃ©jÃ , on redirige vers home.html
      const existingProfile = localStorage.getItem("daylifeProfile");
      const hasCompleted = localStorage.getItem("daylifeHasCompleted") === "true";
      if (existingProfile && hasCompleted) {
        window.location.href = "home.html";
        return;
      }

      // Remplir la liste des langues
      supportedLanguages.forEach((code) => {
        const opt = document.createElement("option");
        opt.value = code;
        opt.textContent =
          (welcomeTranslations[code] && welcomeTranslations[code].langName) ||
          code.toUpperCase();
        langSelect.appendChild(opt);
      });

      // DÃ©tecter la langue du navigateur
      const browserLang = (navigator.language || "en").slice(0, 2);
      let initialLang = "en";
      if (supportedLanguages.includes(browserLang)) {
        initialLang = browserLang;
      }

      // Si on a dÃ©jÃ  une langue stockÃ©e, prioritÃ©
      const storedLang = localStorage.getItem("daylife_lang");
      if (storedLang && supportedLanguages.includes(storedLang)) {
        initialLang = storedLang;
      }

      langSelect.value = initialLang;
      applyLang(initialLang);

      // Quand on change la langue, on sauvegarde dans localStorage
      langSelect.addEventListener("change", () => {
        const newLang = langSelect.value;
        localStorage.setItem("daylife_lang", newLang);
        applyLang(newLang);
      });

      // Remplir la liste des pays
      countries.forEach((c) => {
        const opt = document.createElement("option");
        opt.value = c.code;
        opt.textContent = c.name;
        countrySelect.appendChild(opt);
      });

      // Gestion du formulaire
      const form = document.getElementById("setupForm");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const lang = langSelect.value || "en";
        const t = welcomeTranslations[lang] || welcomeTranslations["en"];

        const dob = document.getElementById("dob").value;
        const sex = document.getElementById("sex").value;
        const country = document.getElementById("country").value;
        const mode = document.getElementById("calculationMode").value;

        if (!dob || !sex || !country) {
          resultEl.textContent = t.errorIncomplete;
          resultEl.className = "welcome-result error";
          return;
        }

        // Calcul des jours vÃ©cus
        const dobDate = new Date(dob);
        const now = new Date();
        const diffMs = now.getTime() - dobDate.getTime();
        const daysLived = Math.floor(diffMs / (1000 * 60 * 60 * 24));

        let totalLifeDays;
        if (mode === "30000_days") {
          totalLifeDays = 30000;
        } else {
          // Mode "by_demographics" => API
          totalLifeDays = await fetchLifeExpectancyDays(country, sex);
        }

        const daysRemaining = Math.max(totalLifeDays - daysLived, 0);

        const profile = {
          dob,
          sex,
          country,
          calculationMode: mode,
          lang,
          daysLived,
          daysRemaining,
          totalLifeDays,
          createdAt: now.toISOString(),
        };

        localStorage.setItem("daylifeProfile", JSON.stringify(profile));
        localStorage.setItem("daylifeHasCompleted", "true");
        localStorage.setItem("daylife_lang", lang);

        resultEl.textContent = t.successSaved;
        resultEl.className = "welcome-result success";

        // Redirection vers la home
        setTimeout(() => {
          window.location.href = "home.html";
        }, 600);
      });
    });
  </script>
</body>
</html>
